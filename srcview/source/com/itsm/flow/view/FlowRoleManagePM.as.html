<!-- saved from url=(0014)about:internet -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>FlowRoleManagePM.as</title>
<link rel="stylesheet" type="text/css" href="../../../../../SourceStyles.css"/>
</head>

<body><pre><span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">common</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">components</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">datagrid</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">CustomdataGrid</span>;

<span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">mx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">collections</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ArrayCollection</span>;
<span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">mx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">core</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Application</span>;
<span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">mx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">events</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">CloseEvent</span>;
<span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">mx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">events</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">DropdownEvent</span>;
<span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">mx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">events</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ListEvent</span>;
<span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">mx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">managers</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">PopUpManager</span>;
<span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">mx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">rpc</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">events</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FaultEvent</span>;
<span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">mx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">rpc</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">events</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ResultEvent</span>;

<span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">GridData</span>:<span class="ActionScriptDefault_Text">ArrayCollection</span>;                           <span class="ActionScriptComment">//所有的数据
</span><span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">SelRoleID</span>:<span class="ActionScriptDefault_Text">String</span>;                                   <span class="ActionScriptComment">//选中角色ID
</span><span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">SelRoleUserID</span>:<span class="ActionScriptDefault_Text">String</span>;                               <span class="ActionScriptComment">//选中角色人员ID
</span><span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">SelRoleOrUser</span>:<span class="ActionScriptDefault_Text">Boolean</span>;                              <span class="ActionScriptComment">//选中是角色或人员
</span><span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">SelArr</span>:<span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;                            <span class="ActionScriptComment">//被选中字段的数据
</span><span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">flowRoleId</span>:<span class="ActionScriptDefault_Text">String</span>;                                  <span class="ActionScriptComment">//选中角色ID
</span><span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">flowRoleUserID</span>:<span class="ActionScriptDefault_Text">String</span>;                              <span class="ActionScriptComment">//选中角色人员流水ID
</span><span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">MuliDel</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;                            <span class="ActionScriptComment">//删除多个数据
</span><span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">NOrM</span>:<span class="ActionScriptDefault_Text">Boolean</span>;                                        <span class="ActionScriptComment">//新增或修改属性
</span><span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">UserID</span>:<span class="ActionScriptDefault_Text">String</span>;                                        <span class="ActionScriptComment">//用于角色人员ID
</span>
<span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">mx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">rpc</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">events</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ResultEvent</span>;
<span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">mx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">rpc</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">events</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FaultEvent</span>;
<span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">mx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">collections</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ArrayCollection</span>;

<span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">events</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Event</span>;
<span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">services</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">flow</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FlowRoleUsersService</span>;
<span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">common</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">utils</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">TAlert</span>;
<span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">services</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">flow</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FlowRoleService</span>;
<span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">services</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">base</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">CusUsersService</span>;
<span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">vo</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FlowRole</span>;
<span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">vo</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FlowRoleUsers</span>;
<span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">itsm</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">common</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">utils</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">AppCore</span>;
<span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">itsm</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">flow</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">app</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GlobalUtil</span>;
<span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">itsm</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">flow</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">view</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">RoleWindow</span>;

<span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">STATE_FLOWROLEMANAGE</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"FlowRoleManage"</span>;
<span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">STATE_SHOWCOMP</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"ShowComp"</span>;
<span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">STATE_SHOWDEPT</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"ShowDept"</span>;
<span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">STATE_SHOWUSERS</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"ShowUsers"</span>;
<span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">STATE_FLOWROLEMODI</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"FlowRoleModi"</span>;
<span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">STATE_FLOWROLEUSERSMODI</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"FlowRoleUsersModi"</span>;
<span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">STATE_COMPSEL</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"CompSel"</span>;
<span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">STATE_DELSEL</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"DelSel"</span>;
<span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">STATE_USERSEL</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"UserSel"</span>;

<span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Bindable</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">FAppCore</span>:<span class="ActionScriptDefault_Text">GlobalUtil</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">GlobalUtil</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getInstence</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;  

<span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">init</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span><span class="ActionScriptBracket/Brace">{</span>
    <span class="ActionScriptComment">//FAppCore.initModelMight(btnBox);
</span>    <span class="ActionScriptDefault_Text">InitData</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
<span class="ActionScriptBracket/Brace">}</span>

<span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">InitData</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
<span class="ActionScriptBracket/Brace">{</span>
    <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">currentState</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">STATE_SHOWDEPT</span>; <span class="ActionScriptComment">// "ShowDept";
</span>    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">service</span>:<span class="ActionScriptDefault_Text">FlowRoleUsersService</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FlowRoleUsersService</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"flowRole"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptString">"FlowRole"</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptComment">//service.GetAll("CompId = "+ FAppCore.FCusUser.CompId,null).addResultListener(receivedRecords); 
</span>    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">obj</span>:<span class="ActionScriptDefault_Text">Object</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Object</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptDefault_Text">obj</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">where</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">"compid="</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">FAppCore</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FCusUser</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">CompId</span>;
    
    <span class="ActionScriptDefault_Text">service</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetAll</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">JSON</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">stringify</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">obj</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addResultListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">receivedRecords</span><span class="ActionScriptBracket/Brace">)</span>; 
<span class="ActionScriptBracket/Brace">}</span> 

<span class="ActionScriptComment">//远程值返回，当页数据
</span><span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">receivedRecords</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">result</span>:<span class="ActionScriptDefault_Text">ResultEvent</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
<span class="ActionScriptBracket/Brace">{</span>
    <span class="ActionScriptComment">//GridData=new ArrayCollection(result.result as Array);
</span>    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">json</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">result</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">result</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">String</span>;
    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">obj</span>:<span class="ActionScriptDefault_Text">Object</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">JSON</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">parse</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">json</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptDefault_Text">GridData</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ArrayCollection</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">obj</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">)</span>;
    
    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">GridData</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptOperator">&gt;</span> 0<span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptDefault_Text">initPage</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//初始化页面
</span><span class="ActionScriptBracket/Brace">}</span>

<span class="ActionScriptComment">//初始化页面
</span><span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">initPage</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
<span class="ActionScriptBracket/Brace">{</span>
    <span class="ActionScriptDefault_Text">Having</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">source</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">GridData</span>;
    <span class="ActionScriptDefault_Text">Having</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">refresh</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">false</span><span class="ActionScriptBracket/Brace">)</span>;
<span class="ActionScriptBracket/Brace">}</span>

<span class="ActionScriptComment">//点击角色，显示该角色人员管辖的部门
</span><span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">ItemClick</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">evt</span>:<span class="ActionScriptDefault_Text">ListEvent</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
<span class="ActionScriptBracket/Brace">{</span>
    <span class="ActionScriptDefault_Text">SelArr</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">evt</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">currentTarget</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">selectedItems</span>;
    <span class="ActionScriptDefault_Text">setDefaultSel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">SelArr</span><span class="ActionScriptBracket/Brace">)</span>;
<span class="ActionScriptBracket/Brace">}</span>

<span class="ActionScriptComment">//设置默认选择数据
</span><span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">setDefaultSel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">selectArray</span>:<span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
<span class="ActionScriptBracket/Brace">{</span>
    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">deptORusers</span>:<span class="ActionScriptDefault_Text">int</span>;
    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">ManageDepts</span>:<span class="ActionScriptDefault_Text">String</span>;
    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">selectArray</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">hasOwnProperty</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"GroupLabel"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">currentState</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">STATE_SHOWDEPT</span>; <span class="ActionScriptComment">// "ShowDept";
</span>        
        <span class="ActionScriptDefault_Text">flowRoleId</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">selectArray</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">children</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FlowRoleID</span>;
        <span class="ActionScriptDefault_Text">flowRoleUserID</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">null</span>;
        <span class="ActionScriptDefault_Text">DeptTree</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">LoadSelDepts</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptReserved">else</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptComment">//state = "ShowDept";
</span>        <span class="ActionScriptDefault_Text">flowRoleId</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">selectArray</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FlowRoleID</span>;
        <span class="ActionScriptDefault_Text">flowRoleUserID</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">selectArray</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">RoleUserID</span>;
        <span class="ActionScriptDefault_Text">deptORusers</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">selectArray</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ManageType</span>;
        <span class="ActionScriptDefault_Text">ManageDepts</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">selectArray</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ManageDepts</span>;
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">selectArray</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ManageType</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptDefault_Text">deptORusers</span> <span class="ActionScriptOperator">=</span> 1;
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">deptORusers</span><span class="ActionScriptOperator">==</span>1<span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">currentState</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">STATE_SHOWDEPT</span>; <span class="ActionScriptComment">//"ShowDept";
</span>            <span class="ActionScriptDefault_Text">DeptTree</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">LoadSelDepts</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ManageDepts</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span><span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">deptORusers</span><span class="ActionScriptOperator">==</span>2<span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">currentState</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">STATE_SHOWCOMP</span>; <span class="ActionScriptComment">// "ShowComp";
</span>            <span class="ActionScriptDefault_Text">CompTree</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">LoadSelComp</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ManageDepts</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">deptORusers</span><span class="ActionScriptOperator">==</span>0<span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">currentState</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">STATE_SHOWUSERS</span>; <span class="ActionScriptComment">// "ShowUsers";
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">strWhere</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">"person_id in ("</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">ManageDepts</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">")"</span>;
            
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">GridSel2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">WhereStr</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ManageDepts</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptDefault_Text">GridSel2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">WhereStr</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"person_id in (0)"</span>;
                <span class="ActionScriptReserved">else</span>
                    <span class="ActionScriptDefault_Text">GridSel2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">WhereStr</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">"person_id in ("</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">ManageDepts</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">")"</span>;
                <span class="ActionScriptDefault_Text">GridSel2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GridLoadData</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">else</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">GridSel2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">WhereStr</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">toLowerCase</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">strWhere</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">toLowerCase</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ManageDepts</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptDefault_Text">GridSel2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">WhereStr</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"person_id in (0)"</span>;
                    <span class="ActionScriptReserved">else</span>
                        <span class="ActionScriptDefault_Text">GridSel2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">WhereStr</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">"person_id in ("</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">ManageDepts</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">")"</span>;
                    <span class="ActionScriptDefault_Text">GridSel2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GridLoadData</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>
        
    <span class="ActionScriptBracket/Brace">}</span>
<span class="ActionScriptBracket/Brace">}</span>

<span class="ActionScriptComment">//删除按钮
</span><span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">Del_Click</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
<span class="ActionScriptBracket/Brace">{</span>
    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">SelArr</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span><span class="ActionScriptOperator">==</span>0<span class="ActionScriptBracket/Brace">)</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptDefault_Text">FAppCore</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">sendSysInfo</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"请选择角色人员"</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptReserved">return</span>;
    <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">SelArr</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">hasOwnProperty</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"GroupLabel"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptDefault_Text">FAppCore</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">sendSysInfo</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"角色不能删除。"</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptReserved">else</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptDefault_Text">MuliDel</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
        <span class="ActionScriptDefault_Text">TAlert</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">show</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"确定要删除该记录吗？"</span><span class="ActionScriptOperator">,</span><span class="ActionScriptString">"提示"</span><span class="ActionScriptOperator">,</span>3<span class="ActionScriptOperator">,</span><span class="ActionScriptReserved">null</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">clickselectHandler</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptBracket/Brace">}</span>
<span class="ActionScriptBracket/Brace">}</span> 

<span class="ActionScriptComment">//删除按钮对话框
</span><span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">clickselectHandler</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">CloseEvent</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
<span class="ActionScriptBracket/Brace">{</span>   
    <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">null</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">flowRoleUserID</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptDefault_Text">TAlert</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">show</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"角色不能删除"</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptReserved">return</span>;
    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">detail</span><span class="ActionScriptOperator">!=</span><span class="ActionScriptDefault_Text">TAlert</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">YES</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>   
        <span class="ActionScriptReserved">return</span>;
    <span class="ActionScriptBracket/Brace">}</span>   
    <span class="ActionScriptReserved">else</span> <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptDefault_Text">MuliDel</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
        <span class="ActionScriptDefault_Text">DelRoleUser</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">flowRoleUserID</span><span class="ActionScriptOperator">,</span><span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span>;
        
    <span class="ActionScriptBracket/Brace">}</span>
<span class="ActionScriptComment">//    flowDesigner.GetAllRole();
</span><span class="ActionScriptBracket/Brace">}</span>

<span class="ActionScriptComment">//删除角色人员对话框
</span><span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">DelRUDialg</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
<span class="ActionScriptBracket/Brace">{</span>
    <span class="ActionScriptDefault_Text">TAlert</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">show</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"删除流程角色将删除下属的所有关联人员？"</span><span class="ActionScriptOperator">,</span><span class="ActionScriptString">"提示"</span><span class="ActionScriptOperator">,</span>3<span class="ActionScriptOperator">,</span><span class="ActionScriptReserved">null</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">DelselectHandler</span><span class="ActionScriptBracket/Brace">)</span>;
<span class="ActionScriptBracket/Brace">}</span> 

<span class="ActionScriptComment">//删除角色人员和角色
</span><span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">DelselectHandler</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">CloseEvent</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
<span class="ActionScriptBracket/Brace">{</span>
    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">detail</span><span class="ActionScriptOperator">!=</span><span class="ActionScriptDefault_Text">TAlert</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">YES</span><span class="ActionScriptBracket/Brace">)</span>
    <span class="ActionScriptBracket/Brace">{</span>   
        <span class="ActionScriptReserved">return</span>;
    <span class="ActionScriptBracket/Brace">}</span>   
    <span class="ActionScriptReserved">else</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">RoleUCount</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">SelArr</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">children</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span>;
        <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;<span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">&lt;</span><span class="ActionScriptDefault_Text">RoleUCount</span>;<span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">tempFRID</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">SelArr</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">children</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">RoleUserID</span>;
            <span class="ActionScriptDefault_Text">DelRoleUser</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">tempFRID</span><span class="ActionScriptOperator">,</span><span class="ActionScriptReserved">false</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptDefault_Text">DelRoles</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptBracket/Brace">}</span>    
<span class="ActionScriptBracket/Brace">}</span>

<span class="ActionScriptComment">//删除角色
</span><span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">DelRoles</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
<span class="ActionScriptBracket/Brace">{</span>
    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">argt</span>:<span class="ActionScriptDefault_Text">Object</span><span class="ActionScriptOperator">=</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">flowRoleId</span><span class="ActionScriptBracket/Brace">]</span>;
    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">service</span>:<span class="ActionScriptDefault_Text">FlowRoleService</span><span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FlowRoleService</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptDefault_Text">service</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Delete</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">flowRoleId</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addResultListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">Del_Over</span><span class="ActionScriptBracket/Brace">)</span>;
<span class="ActionScriptBracket/Brace">}</span>

<span class="ActionScriptComment">//删除角色人员
</span><span class="ActionScriptComment">//FRID:角色人员ID，
</span><span class="ActionScriptComment">//muliDel:是否多级删除
</span><span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">DelRoleUser</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">FRID</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">muliDel</span>:<span class="ActionScriptDefault_Text">Boolean</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
<span class="ActionScriptBracket/Brace">{</span>
    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">argt</span>:<span class="ActionScriptDefault_Text">Object</span><span class="ActionScriptOperator">=</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">FRID</span><span class="ActionScriptBracket/Brace">]</span>;
    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">service</span>:<span class="ActionScriptDefault_Text">FlowRoleUsersService</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FlowRoleUsersService</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"flowRole"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptString">"FlowRole"</span><span class="ActionScriptBracket/Brace">)</span>;
    
<span class="ActionScriptComment">//    service.Delete(int(FRID)).addResultListener(DelU_Over);
</span>    <span class="ActionScriptDefault_Text">service</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Delete</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"{'RoleUserID':'"</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">FRID</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">"'}"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addResultListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">DelU_Over</span><span class="ActionScriptBracket/Brace">)</span>;
<span class="ActionScriptBracket/Brace">}</span>

<span class="ActionScriptComment">//删除角色人员回调事件
</span><span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">DelU_Over</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">result</span>:<span class="ActionScriptDefault_Text">ResultEvent</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
<span class="ActionScriptBracket/Brace">{</span>
    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">MuliDel</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptDefault_Text">InitData</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptDefault_Text">FAppCore</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">closeLoading</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
<span class="ActionScriptBracket/Brace">}</span>

<span class="ActionScriptComment">//删除角色回调事件
</span><span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">Del_Over</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">result</span>:<span class="ActionScriptDefault_Text">ResultEvent</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
<span class="ActionScriptBracket/Brace">{</span>
    <span class="ActionScriptDefault_Text">InitData</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptDefault_Text">FAppCore</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">closeLoading</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
<span class="ActionScriptBracket/Brace">}</span>


<span class="ActionScriptASDoc">/*******************新增角色  *****************************/</span>
<span class="ActionScriptComment">//新增角色
</span><span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">NewRole_Click</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
<span class="ActionScriptBracket/Brace">{</span>
    <span class="ActionScriptDefault_Text">NOrM</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">true</span>;
    <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">currentState</span><span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">STATE_FLOWROLEMODI</span>; <span class="ActionScriptComment">// "FlowRoleModi";
</span>    <span class="ActionScriptDefault_Text">RoleName</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">text</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">""</span>;
    <span class="ActionScriptDefault_Text">Effective</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">selected</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
    <span class="ActionScriptComment">//RoleID = "";
</span><span class="ActionScriptBracket/Brace">}</span>

<span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">new_role_click</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span><span class="ActionScriptBracket/Brace">{</span>
    <span class="ActionScriptDefault_Text">NOrM</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">true</span>;
<span class="ActionScriptComment">//    Effective.selected = true;
</span>    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">roleWindow</span>:<span class="ActionScriptDefault_Text">RoleWindow</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">RoleWindow</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">PopUpManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">createPopUp</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">RoleWindow</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptDefault_Text">PopUpManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">centerPopUp</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">roleWindow</span><span class="ActionScriptBracket/Brace">)</span>;
<span class="ActionScriptBracket/Brace">}</span>

<span class="ActionScriptComment">//修改‘按钮
</span><span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">Modi_Click</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
<span class="ActionScriptBracket/Brace">{</span>
    <span class="ActionScriptDefault_Text">NOrM</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">false</span>;
    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">flowRoleId</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">flowRoleUserID</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span>
    <span class="ActionScriptBracket/Brace">{</span>
        
        <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">currentState</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">STATE_FLOWROLEMODI</span>; <span class="ActionScriptComment">// "FlowRoleModi";
</span>        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">SelArr</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">hasOwnProperty</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"children"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">RoleName</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">text</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">SelArr</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">children</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FlowRoleName</span>;
            <span class="ActionScriptDefault_Text">Effective</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">selected</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">SelArr</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">children</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Effective</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptReserved">else</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">RoleName</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">text</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">SelArr</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FlowRoleName</span>;
            <span class="ActionScriptComment">//RoleID = SelArr[0].children[0].FlowRoleID;
</span>            <span class="ActionScriptDefault_Text">Effective</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">selected</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">SelArr</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Effective</span>;
        <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">flowRoleId</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">flowRoleUserID</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">currentState</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">STATE_DELSEL</span> ; <span class="ActionScriptComment">//"DelSel";
</span>        <span class="ActionScriptDefault_Text">UsersRecords</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptBracket/Brace">}</span>
<span class="ActionScriptBracket/Brace">}</span>

<span class="ActionScriptComment">//新增角色确定按钮
</span><span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">click_OK</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
<span class="ActionScriptBracket/Brace">{</span>
    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">String</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">RoleName</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">text</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">toString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptString">""</span><span class="ActionScriptBracket/Brace">)</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptDefault_Text">FAppCore</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">sendSysInfo</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"请输入流程角色名称"</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptReserved">return</span>;
    <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">RoleData</span>:<span class="ActionScriptDefault_Text">FlowRole</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FlowRole</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">argt</span>:<span class="ActionScriptDefault_Text">Object</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Object</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">service</span>:<span class="ActionScriptDefault_Text">FlowRoleService</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FlowRoleService</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"flowRole"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptString">"FlowRole"</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">NOrM</span><span class="ActionScriptBracket/Brace">)</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptDefault_Text">RoleData</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FlowRoleID</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">flowRoleId</span>;
        <span class="ActionScriptDefault_Text">RoleData</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FlowRoleName</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">RoleName</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">text</span>;
        <span class="ActionScriptDefault_Text">RoleData</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Effective</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Effective</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">selected</span>;
        <span class="ActionScriptDefault_Text">RoleData</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">CompId</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">FAppCore</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FCusUser</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">CompId</span>;
        <span class="ActionScriptComment">//service.Update(RoleData).addResultListener(NewModiRecords);
</span>        <span class="ActionScriptDefault_Text">service</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Update</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">JSON</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">stringify</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">RoleData</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addResultListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">NewModiRecords</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptReserved">else</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptDefault_Text">RoleData</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FlowRoleName</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">RoleName</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">text</span>;
        <span class="ActionScriptDefault_Text">RoleData</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Effective</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Effective</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">selected</span>;
        <span class="ActionScriptDefault_Text">RoleData</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">CompId</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">FAppCore</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FCusUser</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">CompId</span>;
        <span class="ActionScriptComment">//service.Add(RoleData).addResultListener(NewModiRecords);
</span>        <span class="ActionScriptDefault_Text">service</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Add</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">JSON</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">stringify</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">RoleData</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addResultListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">NewModiRecords</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptComment">/*sDataDeal.RemoteMethods.addEventListener(ResultEvent.RESULT, NewModiRecords);*/</span>
<span class="ActionScriptBracket/Brace">}</span>

<span class="ActionScriptComment">//远程值返回，当页数据
</span><span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">NewModiRecords</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">result</span>:<span class="ActionScriptDefault_Text">ResultEvent</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
<span class="ActionScriptBracket/Brace">{</span>
    
    <span class="ActionScriptComment">//var SaveState:int=result.result as int;
</span>    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">json</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">result</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">result</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">String</span>;
    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">obj</span>:<span class="ActionScriptDefault_Text">Object</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">JSON</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">parse</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">json</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">SaveState</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">obj</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">type</span>;
    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">SaveState</span> <span class="ActionScriptOperator">==</span> 1<span class="ActionScriptBracket/Brace">)</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptDefault_Text">InitData</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
<span class="ActionScriptComment">//        FAppCore.showInfotoLeftLowerCorner("保存成功");
</span>        <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">currentState</span> <span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">STATE_SHOWDEPT</span>; <span class="ActionScriptComment">// "ShowDept";
</span>    <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptReserved">else</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptDefault_Text">FAppCore</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">sendSysInfo</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"已经有相同名称流程角色"</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">SelArr</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptOperator">&gt;</span> 0<span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptDefault_Text">setDefaultSel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">SelArr</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptBracket/Brace">}</span>
<span class="ActionScriptComment">//    flowDesigner.GetAllRole();
</span>    <span class="ActionScriptDefault_Text">FAppCore</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">closeLoading</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
<span class="ActionScriptBracket/Brace">}</span>

<span class="ActionScriptComment">//取消按钮
</span><span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">Click_Cannel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
<span class="ActionScriptBracket/Brace">{</span>
    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">SelArr</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptOperator">&gt;</span> 0<span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptDefault_Text">setDefaultSel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">SelArr</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptReserved">else</span>
        <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">currentState</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">STATE_SHOWDEPT</span>; <span class="ActionScriptComment">// "ShowDept";
</span><span class="ActionScriptBracket/Brace">}</span>


<span class="ActionScriptASDoc">/***************新增角色人员 ***************************************************************/</span>

<span class="ActionScriptComment">//新增角色人员
</span><span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">NewUserRole_Click</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
<span class="ActionScriptBracket/Brace">{</span>
    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">flowRoleId</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptDefault_Text">FAppCore</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">sendSysInfo</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"请选中流程角色"</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptComment">//Alert.show("请选中流程角色。", "提示" ); 
</span>        <span class="ActionScriptReserved">return</span>;
    <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptDefault_Text">NOrM</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">true</span>;
    <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">currentState</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">STATE_DELSEL</span>; <span class="ActionScriptComment">// "DelSel";
</span>    <span class="ActionScriptDefault_Text">DeptOrder</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">selected</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">true</span>;
    <span class="ActionScriptDefault_Text">UserSelInput</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">setNull</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptDefault_Text">DeptTreeSel</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">LoadSelDepts</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">""</span><span class="ActionScriptBracket/Brace">)</span>;
    
<span class="ActionScriptBracket/Brace">}</span>

<span class="ActionScriptComment">//打开角色人员维护窗口，设置默认数据
</span><span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">UsersRecords</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">result</span>:<span class="ActionScriptDefault_Text">ResultEvent</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
<span class="ActionScriptBracket/Brace">{</span>
    <span class="ActionScriptComment">//默认数据
</span>    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">NOrM</span><span class="ActionScriptBracket/Brace">)</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptComment">//对已经选择的部门进行勾选
</span>        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">SelArr</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">ManageType</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">SelArr</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ManageType</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">deptUserStr</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">SelArr</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ManageDepts</span>;
            <span class="ActionScriptComment">//管辖部门/人员进行勾选
</span>            <span class="ActionScriptComment">//Effective.selected = SelArr[0].Effective;
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ManageType</span><span class="ActionScriptOperator">==</span>1<span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">currentState</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">STATE_DELSEL</span>; <span class="ActionScriptComment">// "DelSel";
</span>                <span class="ActionScriptDefault_Text">DeptOrder</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">selected</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">true</span>;
                <span class="ActionScriptDefault_Text">DeptTreeSel</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">LoadSelDepts</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">deptUserStr</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ManageType</span><span class="ActionScriptOperator">==</span>2<span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">currentState</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">STATE_COMPSEL</span>; <span class="ActionScriptComment">// "CompSel";
</span>                <span class="ActionScriptDefault_Text">CompOrder</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">selected</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">true</span>;
                <span class="ActionScriptDefault_Text">CompTreeSel</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">LoadSelComp</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">deptUserStr</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ManageType</span><span class="ActionScriptOperator">==</span>0<span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">currentState</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">STATE_USERSEL</span>; <span class="ActionScriptComment">// "UserSel";
</span>                <span class="ActionScriptDefault_Text">NameOrder</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">selected</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">true</span>;
                <span class="ActionScriptDefault_Text">UsersSel</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SetUsersSel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">deptUserStr</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptComment">//角色人员选择
</span>            <span class="ActionScriptDefault_Text">UserID</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">SelArr</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">UserID</span>;
            <span class="ActionScriptDefault_Text">UserSelInput</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SetDefaultValue</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">UserID</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptReserved">else</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">currentState</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">STATE_DELSEL</span>; <span class="ActionScriptComment">// "DelSel";
</span>        <span class="ActionScriptDefault_Text">DeptTreeSel</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">LoadSelDepts</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">""</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptComment">//Effective.selected = true;
</span>    <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptDefault_Text">FAppCore</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">closeLoading</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
<span class="ActionScriptBracket/Brace">}</span>

<span class="ActionScriptComment">//确定按钮
</span><span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">Btnclick_OK</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
<span class="ActionScriptBracket/Brace">{</span>
    <span class="ActionScriptDefault_Text">UserID</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">UserSelInput</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">UserIDArr</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">toString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">UserID</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptString">""</span><span class="ActionScriptBracket/Brace">)</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptDefault_Text">FAppCore</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">sendSysInfo</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"请选择人员"</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptComment">//Alert.show("请输选择人员。", "提示" ); 
</span>        <span class="ActionScriptReserved">return</span>;
    <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">DeptUserStr</span>:<span class="ActionScriptDefault_Text">String</span>;
    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">currentState</span> <span class="ActionScriptOperator">==</span><span class="ActionScriptDefault_Text">STATE_DELSEL</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptComment">// "DelSel"
</span>        <span class="ActionScriptDefault_Text">DeptUserStr</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">DeptTreeSel</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetSelDeptsStr</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">currentState</span><span class="ActionScriptOperator">==</span><span class="ActionScriptDefault_Text">STATE_USERSEL</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptComment">// "UserSel")
</span>        <span class="ActionScriptDefault_Text">DeptUserStr</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">UsersSel</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetUsersIDStr</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">currentState</span><span class="ActionScriptOperator">==</span><span class="ActionScriptDefault_Text">STATE_COMPSEL</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptComment">// "CompSel")
</span>        <span class="ActionScriptDefault_Text">DeptUserStr</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">CompTreeSel</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GetSelCompStr</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">DeptUserStr</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptString">""</span><span class="ActionScriptBracket/Brace">)</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptDefault_Text">FAppCore</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">sendSysInfo</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"请选择管辖的部门或人员"</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptComment">//Alert.show("请输选择人员。", "提示" ); 
</span>        <span class="ActionScriptReserved">return</span>;
    <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">RoleUserData</span>:<span class="ActionScriptDefault_Text">FlowRoleUsers</span><span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FlowRoleUsers</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptDefault_Text">RoleUserData</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">UserID</span><span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">UserID</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptDefault_Text">RoleUserData</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FlowRoleID</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">flowRoleId</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptComment">//RoleUserData.Effective=Effective.selected;
</span>    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">User</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">selectedValue</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">STATE_DELSEL</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptComment">//"DelSel")
</span>        <span class="ActionScriptDefault_Text">RoleUserData</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ManageType</span><span class="ActionScriptOperator">=</span>1;
    <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">User</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">selectedValue</span><span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">STATE_USERSEL</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptComment">//"UserSel")
</span>        <span class="ActionScriptDefault_Text">RoleUserData</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ManageType</span><span class="ActionScriptOperator">=</span>0;
    <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">User</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">selectedValue</span><span class="ActionScriptOperator">==</span><span class="ActionScriptDefault_Text">STATE_COMPSEL</span> <span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptComment">//"CompSel")
</span>        <span class="ActionScriptDefault_Text">RoleUserData</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ManageType</span><span class="ActionScriptOperator">=</span>2;
    
    
    <span class="ActionScriptDefault_Text">RoleUserData</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ManageDepts</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">DeptUserStr</span>;
    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">argt</span>:<span class="ActionScriptDefault_Text">Object</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Object</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">service</span>:<span class="ActionScriptDefault_Text">FlowRoleUsersService</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FlowRoleUsersService</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"flowRole"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptString">"FlowRole"</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">NOrM</span><span class="ActionScriptBracket/Brace">)</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptDefault_Text">RoleUserData</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">RoleUserID</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">flowRoleUserID</span>;
        <span class="ActionScriptDefault_Text">service</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Update</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">JSON</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">stringify</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">RoleUserData</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addResultListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">NewUserModiRecords</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptComment">/*argt=[RoleUserData];
        sDataDeal.DataDeal_QueryToData("GenericDestination", "Ccspm.FlowRoleUsersBLL", "Update", argt);*/</span>
    <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptReserved">else</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptDefault_Text">service</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Add</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">JSON</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">stringify</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">RoleUserData</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addResultListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">NewUserModiRecords</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptComment">/*argt=[RoleUserData];
        sDataDeal.DataDeal_QueryToData("GenericDestination", "Ccspm.FlowRoleUsersBLL", "Add", argt);*/</span>
    <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptComment">//sDataDeal.RemoteMethods.addEventListener(ResultEvent.RESULT, NewUserModiRecords);
</span><span class="ActionScriptBracket/Brace">}</span>

<span class="ActionScriptComment">//远程值返回，当页数据
</span><span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">NewUserModiRecords</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">result</span>:<span class="ActionScriptDefault_Text">ResultEvent</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
<span class="ActionScriptBracket/Brace">{</span>
<span class="ActionScriptComment">//    var SaveState:int=result.result as int;
</span>    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">json</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">result</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">result</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">String</span>;
    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">obj</span>:<span class="ActionScriptDefault_Text">Object</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">JSON</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">parse</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">json</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">SaveState</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">obj</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">type</span>;
    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">SaveState</span> <span class="ActionScriptOperator">==</span> 1<span class="ActionScriptBracket/Brace">)</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptDefault_Text">InitData</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
<span class="ActionScriptComment">//        FAppCore.showInfotoLeftLowerCorner("保存成功");
</span>        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">currentState</span> <span class="ActionScriptOperator">==</span><span class="ActionScriptDefault_Text">STATE_USERSEL</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptComment">// "UserSel")
</span>            <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">currentState</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">STATE_SHOWUSERS</span>; <span class="ActionScriptComment">// "ShowUsers";
</span>        <span class="ActionScriptReserved">else</span>
            <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">currentState</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">STATE_SHOWDEPT</span>; <span class="ActionScriptComment">// "ShowDept";
</span>    <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptReserved">else</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptDefault_Text">FAppCore</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">sendSysInfo</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"已经有相同名称流程角色人员"</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">SelArr</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptOperator">&gt;</span> 0<span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptDefault_Text">setDefaultSel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">SelArr</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptDefault_Text">FAppCore</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">closeLoading</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
<span class="ActionScriptBracket/Brace">}</span>

<span class="ActionScriptComment">//选择部门或人员管辖模式
</span><span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">DeptUserSel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">Event</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
<span class="ActionScriptBracket/Brace">{</span>
    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">currentTarget</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">selectedValue</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptString">"DelSel"</span><span class="ActionScriptBracket/Brace">)</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">currentState</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">STATE_DELSEL</span>; <span class="ActionScriptComment">// "DelSel";
</span>        <span class="ActionScriptDefault_Text">DeptOrder</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">selected</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">true</span>;
    <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">currentTarget</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">selectedValue</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptString">"UserSel"</span><span class="ActionScriptBracket/Brace">)</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">currentState</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">STATE_USERSEL</span>; <span class="ActionScriptComment">// "UserSel";
</span>        <span class="ActionScriptDefault_Text">NameOrder</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">selected</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">true</span>;
    <span class="ActionScriptBracket/Brace">}</span><span class="ActionScriptReserved">else</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">currentState</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">STATE_COMPSEL</span>; <span class="ActionScriptComment">// "CompSel";
</span>        <span class="ActionScriptDefault_Text">CompOrder</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">selected</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">true</span>;
    <span class="ActionScriptBracket/Brace">}</span>
<span class="ActionScriptBracket/Brace">}</span></pre></body>
</html>
