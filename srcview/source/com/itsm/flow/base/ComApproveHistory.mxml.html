<!-- saved from url=(0014)about:internet -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>ComApproveHistory.mxml</title>
<link rel="stylesheet" type="text/css" href="../../../../../SourceStyles.css"/>
</head>

<body><pre><span class="MXMLProcessing_Instruction">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="MXMLComponent_Tag">&lt;s:Group</span><span class="MXMLDefault_Text"> xmlns:fx="</span><span class="MXMLString">http://ns.adobe.com/mxml/2009</span><span class="MXMLDefault_Text">"
           xmlns:s="</span><span class="MXMLString">library://ns.adobe.com/flex/spark</span><span class="MXMLDefault_Text">"
           xmlns:mx="</span><span class="MXMLString">library://ns.adobe.com/flex/mx</span><span class="MXMLDefault_Text">" 
           xmlns:launch="</span><span class="MXMLString">common.flow.view.launch.*</span><span class="MXMLDefault_Text">"
           xmlns:datagrid="</span><span class="MXMLString">common.components.datagrid.*</span><span class="MXMLDefault_Text">"
           width="</span><span class="MXMLString">100%</span><span class="MXMLDefault_Text">" height="</span><span class="MXMLString">100%</span><span class="MXMLDefault_Text">" xmlns:components="</span><span class="MXMLString">common.components.*</span><span class="MXMLDefault_Text">" </span><span class="MXMLComponent_Tag">&gt;</span>
    <span class="MXMLSpecial_Tag">&lt;fx:Script&gt;</span>
        &lt;![CDATA[
            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">itsm</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">flow</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">app</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GlobalUtil</span>;
            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">services</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">flow</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FlowInstenceService</span>;
            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">vo</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FlowNodeInstence</span>;
            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">vo</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FlowNodeModel</span>;
            
            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">common</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">flow</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">model</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">BeginNode</span>;
            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">common</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">flow</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">model</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">EndNode</span>;
            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">common</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">flow</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">model</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Node</span>;
            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">common</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">flow</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">model</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SingleLine</span>;
            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">common</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">flow</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">model</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SpecialTaskNode</span>;
            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">common</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">flow</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">model</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">TaskNode</span>;
            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">common</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">utils</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FAppCoreUtil</span>;
            
            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">mx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">collections</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ArrayCollection</span>;
            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">mx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">core</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Application</span>;
            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">mx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">effects</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Glow</span>;
            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">mx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">rpc</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">events</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ResultEvent</span>;
            
            <span class="ActionScriptReserved">public</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">DATALOADOK</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"AppHisDataLoadOK"</span>;
            
            <span class="ActionScriptReserved">public</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">nodes</span>:<span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">public</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">flowNodeInsteces</span>:<span class="ActionScriptDefault_Text">Array</span>;
            <span class="ActionScriptReserved">public</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">BillId</span>:<span class="ActionScriptDefault_Text">String</span>;
            <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Bindable</span><span class="ActionScriptBracket/Brace">] </span><span class="ActionScriptMetadata">Embed</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"../assets/icon_Form_01.jpg"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>  <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">gridUp</span>:<span class="ActionScriptDefault_Text">Class</span>;
            <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Bindable</span><span class="ActionScriptBracket/Brace">] </span><span class="ActionScriptMetadata">Embed</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"../assets/icon_Form_02.jpg"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>  <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">gridDown</span>:<span class="ActionScriptDefault_Text">Class</span>;
            <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Bindable</span><span class="ActionScriptBracket/Brace">] </span><span class="ActionScriptMetadata">Embed</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"../assets/icon_Graphics_01.jpg"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>  <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">graphicUp</span>:<span class="ActionScriptDefault_Text">Class</span>;
            <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Bindable</span><span class="ActionScriptBracket/Brace">] </span><span class="ActionScriptMetadata">Embed</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"../assets/icon_Graphics_02.jpg"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>  <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">graphicDown</span>:<span class="ActionScriptDefault_Text">Class</span>;
            
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">FAppCore</span>:<span class="ActionScriptDefault_Text">GlobalUtil</span><span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">GlobalUtil</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getInstence</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;    
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">service</span>:<span class="ActionScriptDefault_Text">FlowInstenceService</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FlowInstenceService</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"flowGlobal"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptString">"FlowGlobal"</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">nodeSpace</span>:<span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span>120;
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">thisStageWidth</span> :<span class="ActionScriptDefault_Text">Number</span>;
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">thisStageHeight</span> :<span class="ActionScriptDefault_Text">Number</span>; 
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">currentNodeX</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">nodeSpace</span>;
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">currentNodeY</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 50;
            
            <span class="ActionScriptComment">//定义渲染器中用到的回调函数
</span>            <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">cellColor</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dataField</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">data</span>:<span class="ActionScriptDefault_Text">Object</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">uint</span><span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">//设置前两页显示颜色  dataField=="WarnTag" &amp;&amp;
</span>                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span>  <span class="ActionScriptDefault_Text">data</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptString">"WarnTag"</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">==</span>1<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">return</span> 0xFF0000;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptComment">//设置默认显示颜色
</span>                <span class="ActionScriptReserved">return</span> 0x000000;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">initGrid</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">Event</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>   <span class="ActionScriptComment">//grid初始化
</span>            <span class="ActionScriptBracket/Brace">{</span>            
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">headerArr</span>:<span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptString">"审核ID"</span><span class="ActionScriptOperator">,</span><span class="ActionScriptString">"instID"</span><span class="ActionScriptOperator">,</span>0<span class="ActionScriptOperator">,</span><span class="ActionScriptString">""</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">FAppCoreUtil</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fcInteger</span><span class="ActionScriptOperator">,</span><span class="ActionScriptString">""</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">,</span>                                               
                    <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptString">"审批人"</span><span class="ActionScriptOperator">,</span><span class="ActionScriptString">"handlerName"</span><span class="ActionScriptOperator">,</span>100<span class="ActionScriptOperator">,</span><span class="ActionScriptString">""</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">FAppCoreUtil</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fcString</span><span class="ActionScriptOperator">,</span><span class="ActionScriptString">""</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">,</span>
                    <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptString">"职务"</span><span class="ActionScriptOperator">,</span><span class="ActionScriptString">"flowRoleName"</span><span class="ActionScriptOperator">,</span>100<span class="ActionScriptOperator">,</span><span class="ActionScriptString">""</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">FAppCoreUtil</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fcString</span><span class="ActionScriptOperator">,</span><span class="ActionScriptString">""</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">,</span>
                    <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptString">"审批决定"</span><span class="ActionScriptOperator">,</span><span class="ActionScriptString">"checkStateName"</span><span class="ActionScriptOperator">,</span>100<span class="ActionScriptOperator">,</span><span class="ActionScriptString">""</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">FAppCoreUtil</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fcString</span><span class="ActionScriptOperator">,</span><span class="ActionScriptString">""</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">,</span>
                    <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptString">"审批意见"</span><span class="ActionScriptOperator">,</span><span class="ActionScriptString">"dealWithIdea"</span><span class="ActionScriptOperator">,</span>300<span class="ActionScriptOperator">,</span><span class="ActionScriptString">""</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">FAppCoreUtil</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fcString</span><span class="ActionScriptOperator">,</span><span class="ActionScriptString">""</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">,</span>                                                
                    <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptString">"审批日期"</span><span class="ActionScriptOperator">,</span><span class="ActionScriptString">"handleDate"</span><span class="ActionScriptOperator">,</span>80<span class="ActionScriptOperator">,</span><span class="ActionScriptString">""</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">FAppCoreUtil</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fcString</span><span class="ActionScriptOperator">,</span><span class="ActionScriptString">""</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">,</span>
                    <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptString">"提醒"</span><span class="ActionScriptOperator">,</span><span class="ActionScriptString">"warnTag"</span><span class="ActionScriptOperator">,</span>0<span class="ActionScriptOperator">,</span><span class="ActionScriptString">""</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">FAppCoreUtil</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fcInteger</span><span class="ActionScriptOperator">,</span><span class="ActionScriptString">""</span><span class="ActionScriptBracket/Brace">]</span>
                <span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">with</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">gridMain</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">RemoteDest</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"GenericDestination"</span>;
                    <span class="ActionScriptDefault_Text">RemoteSource</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"Ccspm.FlowInstenceBLL"</span>;
                    <span class="ActionScriptDefault_Text">RemoteOperation</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"getHistory"</span>;             
                    <span class="ActionScriptDefault_Text">isPage</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
                    <span class="ActionScriptDefault_Text">AutoLoad</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
                    <span class="ActionScriptDefault_Text">isMulPage</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
                    <span class="ActionScriptDefault_Text">ShowUpGuide</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
                    <span class="ActionScriptDefault_Text">ShowDownGuide</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
                    <span class="ActionScriptComment">//PageCount = 20;                
</span>                    <span class="ActionScriptComment">// 用户自己初次未进入流程（42:未进入流程  136:流程中 137:流程结束 138:退回；）
</span>                    <span class="ActionScriptComment">//WhereStr=" FlowState in(42,138) and BudgetSourceId=45 and  Applyer='"+FAppCore.FCusUser.UserId.toString()+"'"; // Enabled=1 and ，未进入流程、退回（ 42:未进入流程  136：流程中 137 ：流程结束 138 ：退回；）
</span>                    <span class="ActionScriptDefault_Text">UserID</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">FAppCore</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FCusUser</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">UserId</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">toString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">CustomColumnsModuleName</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">"ApproveHistory"</span>;
                    <span class="ActionScriptDefault_Text">HeaderArray</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">headerArr</span>;
                    <span class="ActionScriptDefault_Text">cellColorFunc</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">cellColor</span>;
                    
                <span class="ActionScriptBracket/Brace">}</span>             
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptASDoc">/**
             * 获取审批历史数据 根据业务类型、业务ID
             * */</span>
            <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span>  <span class="ActionScriptDefault_Text">getApproveHistory</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">aFlowtypeId</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">aBillId</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>  
            <span class="ActionScriptBracket/Brace">{</span>               
                <span class="ActionScriptComment">//FDataService.DataDeal_QueryToData("GenericDestination","Ccspm.FlowInstenceBLL","getHistory",[aFlowtypeId,aBillId]);
</span>                <span class="ActionScriptComment">//FDataService.RemoteMethods.addEventListener(ResultEvent.RESULT,onGetApproveHistory);     
</span>                <span class="ActionScriptComment">//FDataService.DataDeal_QueryToData("GenericDestination", "Ccspm.FlowInstenceBLL", "getFlowNodeInstenceList", [aFlowtypeId,aBillId,FAppCore.FCusUser.CompId]);
</span>                <span class="ActionScriptComment">//FDataService.RemoteMethods.addEventListener(ResultEvent.RESULT, getFlowNodeInstenceListOk);
</span>                <span class="ActionScriptDefault_Text">BillId</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">aBillId</span>;
                <span class="ActionScriptDefault_Text">service</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getHistory</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">aFlowtypeId</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">aBillId</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addResultListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">onGetApproveHistory</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">service</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getFlowNodeInstenceList</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">aFlowtypeId</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">aBillId</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">FAppCore</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FCusUser</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">CompId</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addResultListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">getFlowNodeInstenceListOk</span><span class="ActionScriptBracket/Brace">)</span>;                
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptASDoc">/**
             * 获取审批历史数据 根据业务类型、业务ID
             * showViewStackSelectedIndex 初始显示视图
             * */</span>
            <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getHistoryByFlowInsteceId</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">flowId</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">showViewStackSelectedIndex</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span>1<span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span><span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">//if (showViewStackSelectedIndex&lt;viewstack1.numChildren)
</span>                    <span class="ActionScriptDefault_Text">viewstack1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">selectedIndex</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">showViewStackSelectedIndex</span>;
                <span class="ActionScriptDefault_Text">service</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getHistoryByFlowInsteceId</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">flowId</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addResultListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">onGetApproveHistory</span><span class="ActionScriptBracket/Brace">)</span>
                                                        <span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addResultListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">getFlowNodeInstenceListOk</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getFlowNodeInstenceListOk</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">ResultEvent</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
            <span class="ActionScriptBracket/Brace">{</span>        
                <span class="ActionScriptDefault_Text">drawCanvas</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Lines</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">removeAll</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">drawCanvas</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">removeAllChildren</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">nodes</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span>;
                <span class="ActionScriptDefault_Text">nodes</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptComment">//flowNodeInsteces = event.result as Array;
</span>                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">ac</span>:<span class="ActionScriptDefault_Text">ArrayCollection</span><span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">result</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">ArrayCollection</span>;
                <span class="ActionScriptDefault_Text">flowNodeInsteces</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">ac</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">source</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">currentNode</span>:<span class="ActionScriptDefault_Text">Node</span>;
                <span class="ActionScriptDefault_Text">thisStageWidth</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">stage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span>;
                <span class="ActionScriptDefault_Text">thisStageHeight</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">stage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">height</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">beginNodeModel</span>:<span class="ActionScriptDefault_Text">FlowNodeModel</span>;
                <span class="ActionScriptReserved">for each</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">flowNodeInstece</span>:<span class="ActionScriptDefault_Text">Object</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">flowNodeInsteces</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">flowNodeInstece</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">nodeAttr</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptOperator">-</span>1 <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">flowNodeInstece</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">nodeAttr</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptOperator">-</span>3<span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">beginNodeModel</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">changeInstence2Model</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">flowNodeInstece</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptDefault_Text">currentNode</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">BeginNode</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"开始"</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptDefault_Text">currentNode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">beginNodeModel</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">PointX</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">nodeSpace</span>;
                        <span class="ActionScriptDefault_Text">currentNode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">beginNodeModel</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">PointY</span> <span class="ActionScriptOperator">=</span> 50;
                        <span class="ActionScriptDefault_Text">currentNode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">NodeModel</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">beginNodeModel</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentNode</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span> 
                    <span class="ActionScriptDefault_Text">getNextNodes</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">beginNodeModel</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptReserved">else</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">return</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">singleline</span>:<span class="ActionScriptDefault_Text">SingleLine</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">nextids</span>:<span class="ActionScriptDefault_Text">Array</span>;
                <span class="ActionScriptReserved">for each</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">firstnode</span>:<span class="ActionScriptDefault_Text">Node</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">nodes</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">nextids</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">firstnode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">NodeModel</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">NextID</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">split</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">","</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptReserved">for each</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">secondnode</span>:<span class="ActionScriptDefault_Text">Node</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">nodes</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptReserved">for each</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">nextid</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">nextids</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptBracket/Brace">{</span> 
                            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">secondnode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">NodeModel</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">NodeNumber</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">nextid</span><span class="ActionScriptBracket/Brace">)</span>
                            <span class="ActionScriptBracket/Brace">{</span>
                                <span class="ActionScriptDefault_Text">singleline</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">SingleLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">""</span><span class="ActionScriptBracket/Brace">)</span>;
                                <span class="ActionScriptDefault_Text">singleline</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">beginToEndLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">firstnode</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">secondnode</span><span class="ActionScriptBracket/Brace">)</span>;
                                <span class="ActionScriptDefault_Text">drawCanvas</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addChild</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">singleline</span><span class="ActionScriptBracket/Brace">)</span>;
                                <span class="ActionScriptDefault_Text">drawCanvas</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addLines</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">singleline</span><span class="ActionScriptBracket/Brace">)</span>;
                            <span class="ActionScriptBracket/Brace">}</span>
                        <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">glow</span>:<span class="ActionScriptDefault_Text">Glow</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Glow</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">glow</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">color</span><span class="ActionScriptOperator">=</span> 0xff0000;
                <span class="ActionScriptDefault_Text">glow</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">repeatDelay</span> <span class="ActionScriptOperator">=</span> 100; 
                <span class="ActionScriptDefault_Text">glow</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">duration</span> <span class="ActionScriptOperator">=</span> 700;
                <span class="ActionScriptDefault_Text">glow</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">blurXTo</span> <span class="ActionScriptOperator">=</span> 20;
                <span class="ActionScriptDefault_Text">glow</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">blurYTo</span> <span class="ActionScriptOperator">=</span> 20; 
                <span class="ActionScriptDefault_Text">glow</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">repeatCount</span> <span class="ActionScriptOperator">=</span> 0;  
                <span class="ActionScriptReserved">for each</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">node</span>:<span class="ActionScriptDefault_Text">Node</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">nodes</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">node</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">allowHMove</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
                    <span class="ActionScriptDefault_Text">node</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">allowVMove</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>; 
                    <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">node</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">NodeModel</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">NodeMark</span> <span class="ActionScriptOperator">==</span><span class="ActionScriptString">'142'</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">glow</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">target</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">node</span>;
                        <span class="ActionScriptDefault_Text">glow</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">play</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>; 
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptDefault_Text">node</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">contextMenu</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ContextMenu</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">drawCanvas</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addChild</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">node</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>    
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">onGetApproveHistory</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">aEvent</span>:<span class="ActionScriptDefault_Text">ResultEvent</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">mArr</span>:<span class="ActionScriptDefault_Text">ArrayCollection</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">aEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">result</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">ArrayCollection</span>;
                <span class="ActionScriptDefault_Text">gridMain</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">OnlyInit</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">gridMain</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ManualProvider</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">mArr</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">dispatchEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Event</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">DATALOADOK</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">flowNodeInstecesArrFilter</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">item</span>:<span class="ActionScriptDefault_Text">Object</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Boolean</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">item</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">MakeRubbish</span> <span class="ActionScriptOperator">==</span> 0<span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">true</span>;
                <span class="ActionScriptReserved">else</span>
                    <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">false</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">FlowhistoryGridHandler</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">eventType</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">eventType</span> <span class="ActionScriptOperator">==</span><span class="ActionScriptString">"flowhistoryGridBtClick"</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">gridBt</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">selected</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
                    <span class="ActionScriptDefault_Text">graphicBt</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">selected</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
                    <span class="ActionScriptDefault_Text">viewstack1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">selectedChild</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">gridMain</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">eventType</span> <span class="ActionScriptOperator">==</span><span class="ActionScriptString">"flowhistoryGriphicBtClick"</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">graphicBt</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">selected</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
                    <span class="ActionScriptDefault_Text">gridBt</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">selected</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
                    <span class="ActionScriptDefault_Text">viewstack1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">selectedChild</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">drawCanvas</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getNextNodes</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentNode</span>:<span class="ActionScriptDefault_Text">FlowNodeModel</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
            <span class="ActionScriptBracket/Brace">{</span>
                
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">tempnextids</span>:<span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">currentNode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">NextID</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">split</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">","</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">nextids</span>:<span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">for each</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">entriyNextid</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">tempnextids</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">entriyNextid</span> <span class="ActionScriptOperator">!=</span><span class="ActionScriptString">""</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">nextids</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">entriyNextid</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">nextids</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptOperator">==</span>0<span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">return</span> ;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">nextNode</span>:<span class="ActionScriptDefault_Text">Node</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">nextNodeModel</span>:<span class="ActionScriptDefault_Text">FlowNodeModel</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">flowNodeModels</span>:<span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">flowNodeModel</span>:<span class="ActionScriptDefault_Text">FlowNodeModel</span>;
                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span>0;<span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">flowNodeInsteces</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span>;<span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">obj</span>:<span class="ActionScriptDefault_Text">Object</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">flowNodeInsteces</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;
                    <span class="ActionScriptDefault_Text">flowNodeModel</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FlowNodeModel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">flowNodeModel</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FlowID</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">obj</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">flowId</span>; 
                    <span class="ActionScriptDefault_Text">flowNodeModel</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ModuleCode</span> <span class="ActionScriptOperator">=</span>  <span class="ActionScriptDefault_Text">obj</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">moduleCode</span>;
                    <span class="ActionScriptDefault_Text">flowNodeModel</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">NextID</span> <span class="ActionScriptOperator">=</span>  <span class="ActionScriptDefault_Text">obj</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">nextids</span><span class="ActionScriptOperator">==</span><span class="ActionScriptReserved">null</span><span class="ActionScriptOperator">?</span><span class="ActionScriptString">""</span>:<span class="ActionScriptDefault_Text">obj</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">nextids</span>;
                    <span class="ActionScriptDefault_Text">flowNodeModel</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">NodeAttr</span> <span class="ActionScriptOperator">=</span>  <span class="ActionScriptDefault_Text">obj</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">nodeAttr</span>;
                    <span class="ActionScriptDefault_Text">flowNodeModel</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">NodeID</span> <span class="ActionScriptOperator">=</span>  <span class="ActionScriptDefault_Text">obj</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">nodeId</span>; 
                    <span class="ActionScriptDefault_Text">flowNodeModel</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">NodeNumber</span> <span class="ActionScriptOperator">=</span>  <span class="ActionScriptDefault_Text">obj</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">nodeNumber</span>; 
                    <span class="ActionScriptDefault_Text">flowNodeModel</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">NodeName</span> <span class="ActionScriptOperator">=</span>  <span class="ActionScriptDefault_Text">obj</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">handlerLabel</span>;
                    <span class="ActionScriptDefault_Text">flowNodeModel</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">NodeMark</span> <span class="ActionScriptOperator">=</span>  <span class="ActionScriptDefault_Text">obj</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">checkState</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">""</span>; 
                    <span class="ActionScriptDefault_Text">flowNodeModels</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">flowNodeModel</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">stepY</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;
                <span class="ActionScriptReserved">for each</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">flowNode</span>:<span class="ActionScriptDefault_Text">FlowNodeModel</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">flowNodeModels</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">labelLength</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentNode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">NodeName</span><span class="ActionScriptOperator">?</span><span class="ActionScriptDefault_Text">currentNode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">NodeName</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span><span class="ActionScriptOperator">*</span>12:0<span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">labelLength</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">labelLength</span><span class="ActionScriptOperator">&gt;</span><span class="ActionScriptDefault_Text">nodeSpace</span><span class="ActionScriptOperator">?</span><span class="ActionScriptDefault_Text">labelLength</span>:<span class="ActionScriptDefault_Text">nodeSpace</span><span class="ActionScriptBracket/Brace">)</span>;
                    
                    <span class="ActionScriptDefault_Text">currentNodeX</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">currentNode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">PointX</span>;
                    <span class="ActionScriptDefault_Text">currentNodeY</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">currentNode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">PointY</span>;
                    <span class="ActionScriptDefault_Text">currentNodeX</span><span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">labelLength</span>;
                    <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentNodeX</span><span class="ActionScriptOperator">+</span>2<span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">labelLength</span><span class="ActionScriptOperator">+</span>24<span class="ActionScriptOperator">&gt;=</span><span class="ActionScriptDefault_Text">thisStageWidth</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">currentNodeY</span><span class="ActionScriptOperator">+=</span><span class="ActionScriptDefault_Text">labelLength</span><span class="ActionScriptOperator">/</span>2;
                        <span class="ActionScriptDefault_Text">currentNodeX</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">nodeSpace</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    
                    <span class="ActionScriptComment">/* if(currentNodeY+nodeSpace &gt;=thisStageHeight)
                    {
                        this.height = this.height +nodeSpace;
                    } */</span>
                    <span class="ActionScriptReserved">for each</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">nextid</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">nextids</span> <span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span> 
                        <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">nextid</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">flowNode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">NodeNumber</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptBracket/Brace">{</span>                             
                            <span class="ActionScriptReserved">switch</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">flowNode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">NodeAttr</span><span class="ActionScriptBracket/Brace">)</span>
                            <span class="ActionScriptBracket/Brace">{</span>
                                <span class="ActionScriptReserved">case</span> <span class="ActionScriptOperator">-</span>1:
                                    <span class="ActionScriptDefault_Text">nextNode</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">BeginNode</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">flowNode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">NodeName</span><span class="ActionScriptBracket/Brace">)</span>;
                                    <span class="ActionScriptDefault_Text">nextNode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">nodeSpace</span>;
                                    <span class="ActionScriptDefault_Text">nextNode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">=</span> 50;
                                    <span class="ActionScriptReserved">break</span>;
                                <span class="ActionScriptReserved">case</span> 0:
                                <span class="ActionScriptReserved">case</span> 5:
                                    <span class="ActionScriptDefault_Text">nextNode</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">TaskNode</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">flowNode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">NodeName</span><span class="ActionScriptBracket/Brace">)</span>;
                                    <span class="ActionScriptReserved">break</span>;
                                <span class="ActionScriptReserved">case</span> 1:
                                    <span class="ActionScriptDefault_Text">nextNode</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">SpecialTaskNode</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">flowNode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">NodeName</span><span class="ActionScriptBracket/Brace">)</span>;
                                    <span class="ActionScriptReserved">break</span>; <span class="ActionScriptComment">// 高级节点
</span>                                <span class="ActionScriptReserved">case</span> <span class="ActionScriptOperator">-</span>2:
                                    <span class="ActionScriptDefault_Text">nextNode</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">EndNode</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">flowNode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">NodeName</span><span class="ActionScriptBracket/Brace">)</span>;
                                    <span class="ActionScriptReserved">break</span>; <span class="ActionScriptComment">// 
</span>                                <span class="ActionScriptReserved">case</span> <span class="ActionScriptOperator">-</span>3:
                                    <span class="ActionScriptDefault_Text">nextNode</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">BeginNode</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">flowNode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">NodeName</span><span class="ActionScriptBracket/Brace">)</span>;
                                    <span class="ActionScriptDefault_Text">nextNode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">nodeSpace</span>;
                                    <span class="ActionScriptDefault_Text">nextNode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">=</span> 50;
                                    <span class="ActionScriptReserved">break</span>; <span class="ActionScriptComment">// 
</span>                            <span class="ActionScriptBracket/Brace">}</span> 
                            <span class="ActionScriptDefault_Text">nextNode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">NodeModel</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">flowNode</span>;
                            <span class="ActionScriptDefault_Text">nextNode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">flowNode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">PointX</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">currentNodeX</span>;
                            <span class="ActionScriptDefault_Text">nextNode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">flowNode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">PointY</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">currentNodeY</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">nodeSpace</span><span class="ActionScriptOperator">*</span><span class="ActionScriptDefault_Text">stepY</span><span class="ActionScriptOperator">/</span>2;
                            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">hasAdded</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
                            <span class="ActionScriptReserved">for each</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">reNode</span>:<span class="ActionScriptDefault_Text">Node</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">nodes</span><span class="ActionScriptBracket/Brace">)</span>
                            <span class="ActionScriptBracket/Brace">{</span>
                                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">reNode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">NodeModel</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">NodeNumber</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">nextNode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">NodeModel</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">NodeNumber</span><span class="ActionScriptBracket/Brace">)</span>
                                <span class="ActionScriptBracket/Brace">{</span>
                                    <span class="ActionScriptDefault_Text">hasAdded</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
                                    <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">nextNode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">NodeModel</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">NodeMark</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptString">"142"</span><span class="ActionScriptBracket/Brace">)</span>
                                    <span class="ActionScriptBracket/Brace">{</span>
                                        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">newarr</span>:<span class="ActionScriptDefault_Text">ArrayCollection</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ArrayCollection</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">nodes</span><span class="ActionScriptBracket/Brace">)</span>;
                                        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">renodeint</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ArrayCollection</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">nodes</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getItemIndex</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">reNode</span><span class="ActionScriptBracket/Brace">)</span>;
                                        <span class="ActionScriptDefault_Text">newarr</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">removeItemAt</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">renodeint</span><span class="ActionScriptBracket/Brace">)</span>
                                        <span class="ActionScriptDefault_Text">nodes</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">newarr</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">source</span>;
                                        <span class="ActionScriptDefault_Text">hasAdded</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
                                    <span class="ActionScriptBracket/Brace">}</span>
                                <span class="ActionScriptBracket/Brace">}</span>
                            <span class="ActionScriptBracket/Brace">}</span>
                            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">hasAdded</span><span class="ActionScriptBracket/Brace">)</span>
                            <span class="ActionScriptBracket/Brace">{</span>
                                <span class="ActionScriptDefault_Text">nodes</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">nextNode</span><span class="ActionScriptBracket/Brace">)</span>;
                                <span class="ActionScriptDefault_Text">getNextNodes</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">nextNode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">NodeModel</span><span class="ActionScriptBracket/Brace">)</span>;
                            <span class="ActionScriptBracket/Brace">}</span>
                            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentNode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">NodeAttr</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptOperator">-</span>1 <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">currentNode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">NodeAttr</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptOperator">-</span>3   <span class="ActionScriptBracket/Brace">)</span>
                            <span class="ActionScriptBracket/Brace">{</span>
                                <span class="ActionScriptDefault_Text">nextNode</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">BeginNode</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">currentNode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">NodeName</span><span class="ActionScriptBracket/Brace">)</span>;
                                <span class="ActionScriptDefault_Text">nextNode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">NodeModel</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">currentNode</span>;
                                <span class="ActionScriptDefault_Text">nextNode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">nodeSpace</span>;
                                <span class="ActionScriptDefault_Text">nextNode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">=</span> 50;
                                <span class="ActionScriptDefault_Text">nodes</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">nextNode</span><span class="ActionScriptBracket/Brace">)</span>;
                            <span class="ActionScriptBracket/Brace">}</span>
                            <span class="ActionScriptDefault_Text">stepY</span><span class="ActionScriptOperator">++</span>;
                        <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">changeInstence2Model</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">flownodeInstence</span>:<span class="ActionScriptDefault_Text">Object</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">FlowNodeModel</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">flowNodeModel</span>:<span class="ActionScriptDefault_Text">FlowNodeModel</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FlowNodeModel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">flowNodeModel</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FlowID</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">flownodeInstence</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">flowId</span>; 
                <span class="ActionScriptDefault_Text">flowNodeModel</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ModuleCode</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">flownodeInstence</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">moduleCode</span>;
                <span class="ActionScriptDefault_Text">flowNodeModel</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">NextID</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">flownodeInstence</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">nextids</span><span class="ActionScriptOperator">==</span><span class="ActionScriptReserved">null</span><span class="ActionScriptOperator">?</span><span class="ActionScriptString">""</span>:<span class="ActionScriptDefault_Text">flownodeInstence</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">nextids</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">flowNodeModel</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">NodeAttr</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">flownodeInstence</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">nodeAttr</span>;
                <span class="ActionScriptDefault_Text">flowNodeModel</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">NodeID</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">flownodeInstence</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">nodeId</span>; 
                <span class="ActionScriptDefault_Text">flowNodeModel</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">NodeNumber</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">flownodeInstence</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">nodeNumber</span>; 
                <span class="ActionScriptDefault_Text">flowNodeModel</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">NodeName</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">flownodeInstence</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">handlerName</span>;<span class="ActionScriptComment">// 把处理人名字 存储在 nodename里面
</span>                <span class="ActionScriptDefault_Text">flowNodeModel</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">NodeMark</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">flownodeInstence</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">checkState</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">""</span>; <span class="ActionScriptComment">// 这里把 流程节点的状态  存储在nodemark里
</span>                <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">flowNodeModel</span>;
            <span class="ActionScriptBracket/Brace">}</span>                 
        <span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">&gt;</span>
    <span class="MXMLSpecial_Tag">&lt;/fx:Script&gt;</span>
    <span class="MXMLComponent_Tag">&lt;s:HGroup</span><span class="MXMLDefault_Text"> id="</span><span class="MXMLString">hbMain</span><span class="MXMLDefault_Text">" width="</span><span class="MXMLString">100%</span><span class="MXMLDefault_Text">" height="</span><span class="MXMLString">100%</span><span class="MXMLDefault_Text">" gap="</span><span class="MXMLString">0</span><span class="MXMLDefault_Text">" </span><span class="MXMLComponent_Tag">&gt;</span>
        <span class="MXMLComponent_Tag">&lt;s:VGroup</span><span class="MXMLDefault_Text"> id="</span><span class="MXMLString">btnBox</span><span class="MXMLDefault_Text">" gap="</span><span class="MXMLString">0</span><span class="MXMLDefault_Text">" width="</span><span class="MXMLString">35</span><span class="MXMLDefault_Text">"</span><span class="MXMLComponent_Tag">&gt;</span>
            <span class="MXMLComponent_Tag">&lt;components:ToggleButtonItemRenderer</span><span class="MXMLDefault_Text"> skinClass="</span><span class="MXMLString">common.components.skins.ToggleButtonItemRendererSkin</span><span class="MXMLDefault_Text">"  id="</span><span class="MXMLString">gridBt</span><span class="MXMLDefault_Text">" click="</span><span class="ActionScriptDefault_Text">FlowhistoryGridHandler</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'flowhistoryGridBtClick'</span><span class="ActionScriptBracket/Brace">)</span>;<span class="MXMLDefault_Text">"
                                                 selected="</span><span class="MXMLString">true</span><span class="MXMLDefault_Text">" icon="</span><span class="MXMLString">{</span><span class="ActionScriptDefault_Text">gridUp</span><span class="MXMLString">}</span><span class="MXMLDefault_Text">" iconUp="</span><span class="MXMLString">{</span><span class="ActionScriptDefault_Text">gridUp</span><span class="MXMLString">}</span><span class="MXMLDefault_Text">" iconDown="</span><span class="MXMLString">{</span><span class="ActionScriptDefault_Text">gridDown</span><span class="MXMLString">}</span><span class="MXMLDefault_Text">"</span><span class="MXMLComponent_Tag">/&gt;</span>
            <span class="MXMLComponent_Tag">&lt;components:ToggleButtonItemRenderer</span><span class="MXMLDefault_Text"> skinClass="</span><span class="MXMLString">common.components.skins.ToggleButtonItemRendererSkin</span><span class="MXMLDefault_Text">"  id="</span><span class="MXMLString">graphicBt</span><span class="MXMLDefault_Text">" click="</span><span class="ActionScriptDefault_Text">FlowhistoryGridHandler</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'flowhistoryGriphicBtClick'</span><span class="ActionScriptBracket/Brace">)</span>;<span class="MXMLDefault_Text">"
                                                 icon="</span><span class="MXMLString">{</span><span class="ActionScriptDefault_Text">graphicUp</span><span class="MXMLString">}</span><span class="MXMLDefault_Text">" iconUp="</span><span class="MXMLString">{</span><span class="ActionScriptDefault_Text">graphicUp</span><span class="MXMLString">}</span><span class="MXMLDefault_Text">" iconDown="</span><span class="MXMLString">{</span><span class="ActionScriptDefault_Text">graphicDown</span><span class="MXMLString">}</span><span class="MXMLDefault_Text">"</span><span class="MXMLComponent_Tag">/&gt;</span>
            <span class="MXMLComment">&lt;!--</span><span class="MXMLComment">&lt;mx:Button id="gridBt" click="FlowhistoryGridHandler('flowhistoryGridBtClick');"
                       downSkin="{gridDown}" overSkin="{gridDown}" selected="true"
                       selectedDownSkin="{gridDown}" selectedOverSkin="{gridDown}"
                       selectedUpSkin="{gridDown}" upSkin="{gridUp}"/&gt;
            &lt;mx:Button id="graphicBt" click="FlowhistoryGridHandler('flowhistoryGriphicBtClick');"
                       downSkin="{graphicDown}" overSkin="{graphicDown}"
                       selectedDownSkin="{graphicDown}" selectedOverSkin="{graphicDown}"
                       selectedUpSkin="{graphicDown}" upSkin="{graphicUp}"/&gt;</span><span class="MXMLComment">--&gt;</span>
        <span class="MXMLComponent_Tag">&lt;/s:VGroup&gt;</span>
        <span class="MXMLComponent_Tag">&lt;mx:ViewStack</span><span class="MXMLDefault_Text"> id="</span><span class="MXMLString">viewstack1</span><span class="MXMLDefault_Text">" y="</span><span class="MXMLString">0</span><span class="MXMLDefault_Text">" width="</span><span class="MXMLString">100%</span><span class="MXMLDefault_Text">" height="</span><span class="MXMLString">100%</span><span class="MXMLDefault_Text">" creationPolicy="</span><span class="MXMLString">all</span><span class="MXMLDefault_Text">"
                      horizontalScrollPolicy="</span><span class="MXMLString">off</span><span class="MXMLDefault_Text">" verticalScrollPolicy="</span><span class="MXMLString">off</span><span class="MXMLDefault_Text">"</span><span class="MXMLComponent_Tag">&gt;</span>
            <span class="MXMLComponent_Tag">&lt;datagrid:CustomdataGrid</span><span class="MXMLDefault_Text"> id="</span><span class="MXMLString">gridMain</span><span class="MXMLDefault_Text">" x="</span><span class="MXMLString">0</span><span class="MXMLDefault_Text">" y="</span><span class="MXMLString">0</span><span class="MXMLDefault_Text">" width="</span><span class="MXMLString">100%</span><span class="MXMLDefault_Text">" height="</span><span class="MXMLString">100%</span><span class="MXMLDefault_Text">"
                                     AutoDataBind="</span><span class="MXMLString">false</span><span class="MXMLDefault_Text">" AutoLoad="</span><span class="MXMLString">false</span><span class="MXMLDefault_Text">"
                                     initGrid="</span><span class="ActionScriptBracket/Brace">{</span> <span class="ActionScriptDefault_Text">initGrid</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">}</span><span class="MXMLDefault_Text">" ShowDownGuide="</span><span class="MXMLString">false</span><span class="MXMLDefault_Text">"
                                     ShowUpGuide="</span><span class="MXMLString">false</span><span class="MXMLDefault_Text">"</span><span class="MXMLComponent_Tag">&gt;</span>
            <span class="MXMLComponent_Tag">&lt;/datagrid:CustomdataGrid&gt;</span>
            <span class="MXMLComponent_Tag">&lt;launch:LaunchDrawCanvas</span><span class="MXMLDefault_Text">  label="</span><span class="MXMLString">图标展示</span><span class="MXMLDefault_Text">" id="</span><span class="MXMLString">drawCanvas</span><span class="MXMLDefault_Text">"</span><span class="MXMLComponent_Tag">/&gt;</span>        
        <span class="MXMLComponent_Tag">&lt;/mx:ViewStack&gt;</span>
    <span class="MXMLComponent_Tag">&lt;/s:HGroup&gt;</span>
<span class="MXMLComponent_Tag">&lt;/s:Group&gt;</span></pre></body>
</html>
